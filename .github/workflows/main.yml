name: Push out directory to repo

on:
  workflow_dispatch:

jobs:
  push-to-repo:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: GIT
        run: |
          git config --global user.name WHO53
          git config --global user.email notwho53@gmail.com

      - name: DumperX
        run: |
          git clone https://github.com/DumprX/DumprX ~/D
          cd ~/D
          bash setup.sh
          wget -O rom.zip https://mirrors-obs-2.lolinet.com/firmware/lenowow/2019/Tab_8/TB-8505X/TB-8505X_S320029_220720_BMP.zip
          bash dumper.sh rom.zip
          find ~/D/out -type f -name "*.apk" -delete

      - name: Commit and push changes
        run: |
          git clone https://${{ secrets.PAT }}@github.com/WHO53/rom-lenovo-akita-a9.git ~/rom
          cd ~/rom
          mkdir ../temp
          mv -r * ../temp
          mkdir a9-200901
          mv ../temp/* a9-200901
          mkdir a10-220720
          cp -r ~/D/out/* ~/a9/a10-220720
          git add -A
          git commit -m "i"
          git push
